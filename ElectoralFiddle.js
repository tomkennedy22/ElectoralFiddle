var StateCensusData = {
  'Alabama': {
    'Hispanic': 192987,
    'White': 3204483,
    'Black': 1269503,
    'Native': 21957,
    'Asian': 58683,
    'Pacific': 1542,
    'Men': 2341089,
    'Women': 2489527,
    'TotalPop': 4830616,
    'Citizen': 3620990,
    'State': 'Alabama'
  },
  'Alaska': {
    'Hispanic': 47731,
    'White': 457374,
    'Black': 23676,
    'Native': 98363,
    'Asian': 42280,
    'Pacific': 8464,
    'Men': 384160,
    'Women': 349202,
    'TotalPop': 733362,
    'Citizen': 523933,
    'State': 'Alaska'
  },
  'Arizona': {
    'Hispanic': 2013943,
    'White': 3752031,
    'Black': 263430,
    'Native': 264548,
    'Asian': 194060,
    'Pacific': 11228,
    'Men': 3299088,
    'Women': 3342840,
    'TotalPop': 6641928,
    'Citizen': 4526594,
    'State': 'Arizona'
  },
  'Arkansas': {
    'Hispanic': 202878,
    'White': 2176968,
    'Black': 456441,
    'Native': 16253,
    'Asian': 39821,
    'Pacific': 6698,
    'Men': 1451913,
    'Women': 1506295,
    'TotalPop': 2958208,
    'Citizen': 2164083,
    'State': 'Arkansas'
  },
  'California': {
    'Hispanic': 14736334,
    'White': 14870829,
    'Black': 2151335,
    'Native': 140116,
    'Asian': 5188324,
    'Pacific': 137738,
    'Men': 19064148,
    'Women': 19334324,
    'TotalPop': 38398472,
    'Citizen': 24259881,
    'State': 'California'
  },
  'Colorado': {
    'Hispanic': 1110751,
    'White': 3643834,
    'Black': 201640,
    'Native': 27699,
    'Asian': 149588,
    'Pacific': 6762,
    'Men': 2644019,
    'Women': 2630239,
    'TotalPop': 5274258,
    'Citizen': 3746612,
    'State': 'Colorado'
  },
  'Connecticut': {
    'Hispanic': 525535,
    'White': 2486030,
    'Black': 345035,
    'Native': 4757,
    'Asian': 149033,
    'Pacific': 725,
    'Men': 1749557,
    'Women': 1841615,
    'TotalPop': 3591172,
    'Citizen': 2572163,
    'State': 'Connecticut'
  },
  'Delaware': {
    'Hispanic': 80590,
    'White': 591826,
    'Black': 194974,
    'Native': 2510,
    'Asian': 33280,
    'Pacific': 142,
    'Men': 448413,
    'Women': 478041,
    'TotalPop': 926454,
    'Citizen': 681606,
    'State': 'Delaware'
  },
  'District of Columbia': {
    'Hispanic': 65713,
    'White': 230419,
    'Black': 310586,
    'Native': 1233,
    'Asian': 23416,
    'Pacific': 217,
    'Men': 306674,
    'Women': 340810,
    'TotalPop': 647484,
    'Citizen': 485116,
    'State': 'District of Columbia'
  },
  'Florida': {
    'Hispanic': 4658733,
    'White': 11011588,
    'Black': 3033746,
    'Native': 39846,
    'Asian': 498278,
    'Pacific': 9471,
    'Men': 9599950,
    'Women': 10045746,
    'TotalPop': 19645696,
    'Citizen': 13932985,
    'State': 'Florida'
  },
  'Georgia': {
    'Hispanic': 914298,
    'White': 5459298,
    'Black': 3053414,
    'Native': 17978,
    'Asian': 357581,
    'Pacific': 3998,
    'Men': 4883321,
    'Women': 5123362,
    'TotalPop': 10006683,
    'Citizen': 6978650,
    'State': 'Georgia'
  },
  'Hawaii': {
    'Hispanic': 139094,
    'White': 321663,
    'Black': 26565,
    'Native': 2078,
    'Asian': 517129,
    'Pacific': 127346,
    'Men': 709871,
    'Women': 696428,
    'TotalPop': 1406299,
    'Citizen': 1001729,
    'State': 'Hawaii'
  },
  'Idaho': {
    'Hispanic': 191132,
    'White': 1342519,
    'Black': 9242,
    'Native': 17127,
    'Asian': 20484,
    'Pacific': 1708,
    'Men': 810464,
    'Women': 806083,
    'TotalPop': 1616547,
    'Citizen': 1130550,
    'State': 'Idaho'
  },
  'Illinois': {
    'Hispanic': 2121336,
    'White': 8040308,
    'Black': 1817547,
    'Native': 13843,
    'Asian': 639861,
    'Pacific': 2510,
    'Men': 6316899,
    'Women': 6556862,
    'TotalPop': 12873761,
    'Citizen': 8979999,
    'State': 'Illinois'
  },
  'Indiana': {
    'Hispanic': 420520,
    'White': 5287498,
    'Black': 593667,
    'Native': 11486,
    'Asian': 120520,
    'Pacific': 1758,
    'Men': 3235263,
    'Women': 3333382,
    'TotalPop': 6568645,
    'Citizen': 4801113,
    'State': 'Indiana'
  },
  'Iowa': {
    'Hispanic': 167755,
    'White': 2703140,
    'Black': 95328,
    'Native': 8081,
    'Asian': 62245,
    'Pacific': 1764,
    'Men': 1534595,
    'Women': 1558931,
    'TotalPop': 3093526,
    'Citizen': 2285126,
    'State': 'Iowa'
  },
  'Kansas': {
    'Hispanic': 322898,
    'White': 2228474,
    'Black': 163683,
    'Native': 19954,
    'Asian': 74831,
    'Pacific': 1588,
    'Men': 1439858,
    'Women': 1453125,
    'TotalPop': 2892983,
    'Citizen': 2053915,
    'State': 'Kansas'
  },
  'Kentucky': {
    'Hispanic': 142962,
    'White': 3761549,
    'Black': 341814,
    'Native': 7183,
    'Asian': 54770,
    'Pacific': 2032,
    'Men': 2164197,
    'Women': 2233145,
    'TotalPop': 4397342,
    'Citizen': 3297097,
    'State': 'Kentucky'
  },
  'Louisiana': {
    'Hispanic': 217646,
    'White': 2750536,
    'Black': 1473776,
    'Native': 24136,
    'Asian': 76862,
    'Pacific': 1716,
    'Men': 2261156,
    'Women': 2364097,
    'TotalPop': 4625253,
    'Citizen': 3410634,
    'State': 'Louisiana'
  },
  'Maine': {
    'Hispanic': 19309,
    'White': 1247591,
    'Black': 14324,
    'Native': 7427,
    'Asian': 14311,
    'Pacific': 153,
    'Men': 650081,
    'Women': 679019,
    'TotalPop': 1329100,
    'Citizen': 1048274,
    'State': 'Maine'
  },
  'Maryland': {
    'Hispanic': 533025,
    'White': 3143399,
    'Black': 1722566,
    'Native': 11515,
    'Asian': 354782,
    'Pacific': 2308,
    'Men': 2872643,
    'Women': 3057895,
    'TotalPop': 5930538,
    'Citizen': 4182241,
    'State': 'Maryland'
  },
  'Massachusetts': {
    'Hispanic': 707155,
    'White': 4981460,
    'Black': 433784,
    'Native': 7792,
    'Asian': 397947,
    'Pacific': 1238,
    'Men': 3249650,
    'Women': 3455936,
    'TotalPop': 6705586,
    'Citizen': 4850598,
    'State': 'Massachusetts'
  },
  'Michigan': {
    'Hispanic': 465557,
    'White': 7511679,
    'Black': 1364469,
    'Native': 46319,
    'Asian': 266618,
    'Pacific': 1754,
    'Men': 4860103,
    'Women': 5038585,
    'TotalPop': 9898688,
    'Citizen': 7378276,
    'State': 'Michigan'
  },
  'Minnesota': {
    'Hispanic': 270136,
    'White': 4426556,
    'Black': 292445,
    'Native': 51066,
    'Asian': 238831,
    'Pacific': 1592,
    'Men': 2690300,
    'Women': 2727005,
    'TotalPop': 5417305,
    'Citizen': 3949037,
    'State': 'Minnesota'
  },
  'Mississippi': {
    'Hispanic': 86156,
    'White': 1714322,
    'Black': 1112160,
    'Native': 11871,
    'Asian': 28579,
    'Pacific': 360,
    'Men': 1451627,
    'Women': 1536358,
    'TotalPop': 2987985,
    'Citizen': 2210338,
    'State': 'Mississippi'
  },
  'Missouri': {
    'Hispanic': 232312,
    'White': 4849198,
    'Black': 690956,
    'Native': 22064,
    'Asian': 104985,
    'Pacific': 5735,
    'Men': 2964003,
    'Women': 3081432,
    'TotalPop': 6045435,
    'Citizen': 4525027,
    'State': 'Missouri'
  },
  'Montana': {
    'Hispanic': 33436,
    'White': 882017,
    'Black': 4470,
    'Native': 63290,
    'Asian': 6813,
    'Pacific': 792,
    'Men': 509613,
    'Women': 504536,
    'TotalPop': 1014149,
    'Citizen': 780705,
    'State': 'Montana'
  },
  'Nebraska': {
    'Hispanic': 185826,
    'White': 1508702,
    'Black': 85180,
    'Native': 12988,
    'Asian': 37525,
    'Pacific': 1104,
    'Men': 928333,
    'Women': 939759,
    'TotalPop': 1868092,
    'Citizen': 1332645,
    'State': 'Nebraska'
  },
  'Nevada': {
    'Hispanic': 770299,
    'White': 1454957,
    'Black': 225432,
    'Native': 24361,
    'Asian': 210891,
    'Pacific': 16899,
    'Men': 1407735,
    'Women': 1390901,
    'TotalPop': 2798636,
    'Citizen': 1863799,
    'State': 'Nevada'
  },
  'New Hampshire': {
    'Hispanic': 42012,
    'White': 1210214,
    'Black': 15367,
    'Native': 1867,
    'Asian': 30985,
    'Pacific': 223,
    'Men': 653484,
    'Women': 670717,
    'TotalPop': 1324201,
    'Citizen': 1020130,
    'State': 'New Hampshire'
  },
  'New Jersey': {
    'Hispanic': 1685401,
    'White': 5090879,
    'Black': 1126244,
    'Native': 9455,
    'Asian': 798581,
    'Pacific': 2036,
    'Men': 4334342,
    'Women': 4561340,
    'TotalPop': 8895682,
    'Citizen': 6045588,
    'State': 'New Jersey'
  },
  'New Mexico': {
    'Hispanic': 986748,
    'White': 816829,
    'Black': 37912,
    'Native': 177026,
    'Asian': 27048,
    'Pacific': 874,
    'Men': 1032414,
    'Women': 1051703,
    'TotalPop': 2084117,
    'Citizen': 1457632,
    'State': 'New Mexico'
  },
  'New York': {
    'Hispanic': 3615581,
    'White': 11166265,
    'Black': 2826017,
    'Native': 45610,
    'Asian': 1556240,
    'Pacific': 4647,
    'Men': 9534461,
    'Women': 10131312,
    'TotalPop': 19665773,
    'Citizen': 13524612,
    'State': 'New York'
  },
  'North Carolina': {
    'Hispanic': 868572,
    'White': 6322737,
    'Black': 2082620,
    'Native': 107623,
    'Asian': 241485,
    'Pacific': 5158,
    'Men': 4794171,
    'Women': 5049925,
    'TotalPop': 9844096,
    'Citizen': 7106853,
    'State': 'North Carolina'
  },
  'North Dakota': {
    'Hispanic': 20476,
    'White': 628060,
    'Black': 11496,
    'Native': 37429,
    'Asian': 8766,
    'Pacific': 266,
    'Men': 367963,
    'Women': 353677,
    'TotalPop': 721640,
    'Citizen': 546486,
    'State': 'North Dakota'
  },
  'Ohio': {
    'Hispanic': 389414,
    'White': 9287910,
    'Black': 1390943,
    'Native': 16580,
    'Asian': 213401,
    'Pacific': 2562,
    'Men': 5659383,
    'Women': 5913084,
    'TotalPop': 11572467,
    'Citizen': 8705584,
    'State': 'Ohio'
  },
  'Oklahoma': {
    'Hispanic': 370918,
    'White': 2590811,
    'Black': 273694,
    'Native': 266970,
    'Asian': 73007,
    'Pacific': 4397,
    'Men': 1906944,
    'Women': 1942789,
    'TotalPop': 3849733,
    'Citizen': 2768561,
    'State': 'Oklahoma'
  },
  'Oregon': {
    'Hispanic': 485226,
    'White': 3042508,
    'Black': 68797,
    'Native': 36022,
    'Asian': 154048,
    'Pacific': 14154,
    'Men': 1948453,
    'Women': 1990780,
    'TotalPop': 3939233,
    'Citizen': 2867670,
    'State': 'Oregon'
  },
  'Pennsylvania': {
    'Hispanic': 813031,
    'White': 9976400,
    'Black': 1343056,
    'Native': 14031,
    'Asian': 388403,
    'Pacific': 2148,
    'Men': 6239782,
    'Women': 6534207,
    'TotalPop': 12773989,
    'Citizen': 9705265,
    'State': 'Pennsylvania'
  },
  'Rhode Island': {
    'Hispanic': 143668,
    'White': 785125,
    'Black': 56145,
    'Native': 3863,
    'Asian': 33538,
    'Pacific': 339,
    'Men': 510388,
    'Women': 543273,
    'TotalPop': 1053661,
    'Citizen': 776565,
    'State': 'Rhode Island'
  },
  'South Carolina': {
    'Hispanic': 253155,
    'White': 3050043,
    'Black': 1302085,
    'Native': 13661,
    'Asian': 66068,
    'Pacific': 2413,
    'Men': 2319457,
    'Women': 2455163,
    'TotalPop': 4774620,
    'Citizen': 3563745,
    'State': 'South Carolina'
  },
  'South Dakota': {
    'Hispanic': 27800,
    'White': 701616,
    'Black': 12706,
    'Native': 69852,
    'Asian': 10072,
    'Pacific': 312,
    'Men': 423477,
    'Women': 419713,
    'TotalPop': 843190,
    'Citizen': 621770,
    'State': 'South Dakota'
  },
  'Tennessee': {
    'Hispanic': 319466,
    'White': 4856091,
    'Black': 1082982,
    'Native': 14032,
    'Asian': 100886,
    'Pacific': 2928,
    'Men': 3167756,
    'Women': 3331859,
    'TotalPop': 6499615,
    'Citizen': 4828366,
    'State': 'Tennessee'
  },
  'Texas': {
    'Hispanic': 10193748,
    'White': 11633145,
    'Black': 3068342,
    'Native': 64361,
    'Asian': 1108865,
    'Pacific': 18512,
    'Men': 13171308,
    'Women': 13367298,
    'TotalPop': 26538606,
    'Citizen': 16864954,
    'State': 'Texas'
  },
  'Utah': {
    'Hispanic': 389549,
    'White': 2307791,
    'Black': 29284,
    'Native': 27341,
    'Asian': 62803,
    'Pacific': 25354,
    'Men': 1459229,
    'Women': 1444150,
    'TotalPop': 2903379,
    'Citizen': 1868008,
    'State': 'Utah'
  },
  'Vermont': {
    'Hispanic': 10606,
    'White': 586451,
    'Black': 6656,
    'Native': 1813,
    'Asian': 8603,
    'Pacific': 177,
    'Men': 308573,
    'Women': 318031,
    'TotalPop': 626604,
    'Citizen': 493124,
    'State': 'Vermont'
  },
  'Virginia': {
    'Hispanic': 708226,
    'White': 5236924,
    'Black': 1559413,
    'Native': 16665,
    'Asian': 488844,
    'Pacific': 4883,
    'Men': 4060948,
    'Women': 4195666,
    'TotalPop': 8256614,
    'Citizen': 5948609,
    'State': 'Virginia'
  },
  'Washington': {
    'Hispanic': 834725,
    'White': 4942608,
    'Black': 243263,
    'Native': 80277,
    'Asian': 530210,
    'Pacific': 42186,
    'Men': 3487725,
    'Women': 3497739,
    'TotalPop': 6985464,
    'Citizen': 4937212,
    'State': 'Washington'
  },
  'West Virginia': {
    'Hispanic': 25236,
    'White': 1713231,
    'Black': 60181,
    'Native': 2644,
    'Asian': 13179,
    'Pacific': 459,
    'Men': 913631,
    'Women': 937789,
    'TotalPop': 1851420,
    'Citizen': 1455848,
    'State': 'West Virginia'
  },
  'Wisconsin': {
    'Hispanic': 363826,
    'White': 4728754,
    'Black': 353101,
    'Native': 45670,
    'Asian': 142161,
    'Pacific': 1044,
    'Men': 2850148,
    'Women': 2890732,
    'TotalPop': 5740880,
    'Citizen': 4293094,
    'State': 'Wisconsin'
  },
  'Wyoming': {
    'Hispanic': 55612,
    'White': 489575,
    'Black': 5914,
    'Native': 10956,
    'Asian': 5119,
    'Pacific': 376,
    'Men': 295561,
    'Women': 284118,
    'TotalPop': 579679,
    'Citizen': 430026,
    'State': 'Wyoming'
  },
  'Puerto Rico': {
    'Hispanic': 3546961,
    'White': 24660,
    'Black': 2755,
    'Native': 65,
    'Asian': 2280,
    'Pacific': 56,
    'Men': 1713857,
    'Women': 1869213,
    'TotalPop': 3583070,
    'Citizen': 2726220,
    'State': 'Puerto Rico'
  }
};


var DemographicData = {
    'White': {'Default': 44},
    'Black': {'Default': 64},
    'Hispanic': {'Default': 52},
    'Native': {'Default': 55},
    'Asian': {'Default': 51},
    'Pacific': {'Default': 71},
}

function Max(a,b){
  if (a > b) {
    return a;
  }
  return b;
}

function Min(a,b){
  if (a < b) {
    return a;
  }
  return b;
}


function HandleDisplay(Handle, Value){
  if (Value > 50){
    var HandleVal = 'B +' + ((Value-50) * 2).toString();
  }
  else if (Value < 50) {
    var HandleVal = 'R +' + ((50 - Value) * 2).toString();
  }
  else {
    var HandleVal = '-'
  }

  $(Handle).text(HandleVal);
}

function ColorFromValue(Val){
  var BluePercent = Val / 100.0;
  var RedPercent = 1 - BluePercent;

  BluePercent = ((BluePercent * 2) ** 5) / 2
  RedPercent = ((RedPercent * 2) ** 5) / 2

  var Blue_Dec = Max(Min(Math.ceil( 16 * BluePercent), 15), 0);
  var Red_Dec = Max(Min(Math.ceil( 16 * RedPercent), 15), 0);

  var Blue_Hex = Blue_Dec.toString(16);
  var Red_Hex = Red_Dec.toString(16);

  return '#'+Red_Hex + '0'+ Blue_Hex;
}

function ColorStates(){
  $.each(StateCensusData, function(StateName, StateObj){
    var svg = $('path[statename="'+StateName+'"]');

    var StateTotalPop = 0;
    var StateBlueVotes = 0;
    var StateRedVotes = 0;

    $('.slider-td').each(function(ind, td){
      var Ethnicity = $(td).attr('ethnicity');
      var BluePercent = $(td).slider('option', 'value') / 100.0;
      var RedPercent = 1 - BluePercent;

      StateBlueVotes += StateObj[Ethnicity] * BluePercent;
      StateRedVotes += StateObj[Ethnicity] * RedPercent;

      StateTotalPop +=  StateObj[Ethnicity];
    });

    var StateBluePercentage = StateBlueVotes / StateTotalPop;
    var Color_Hex = ColorFromValue(StateBluePercentage * 100);
    $(svg).attr('fill', Color_Hex);
  });
}

$(document).ready(function(){
  console.log('In js');

  var Colors = {
      'R': {'Min': '2', 'Max': 'F'},
      'G': {'Min': '0', 'Max': '0'},
      'B': {'Min': '2', 'Max': 'F'},
  }

  $.each(StateCensusData, function(StateName, StateObj){
    console.log('StateName, StateObj', StateName, StateObj);

    $('path[statename="'+StateName+'"]').find('title').text(StateObj.TotalPop);
  });

  var EthnicityHeader = $('#ethnicity-header');
  var EthnicitySliders = $('#ethnicity-slider');

  var SliderList = [];

  $.each(DemographicData, function(Ethnicity, EthnicityObj){

    EthnicityHeader.append('<th>'+Ethnicity+'</th>')

    var NewSlider = $(`<td style=' width: 20px;' class='slider-td' ethnicity='`+Ethnicity+`'>
        <div class="slider-vertical" style="height:200px;"></div>
    </td>`)

    var SliderObj = $( NewSlider ).slider({
        orientation: "vertical",
        range: "min",
        min: 0,
        max: 100,
        value: EthnicityObj.Default,
        create: function( event, ui ) {
          var Color_Hex = ColorFromValue(EthnicityObj.Default)
          $(event.target).find('.ui-slider-range').css('background-color', Color_Hex);
        },
        slide: function( event, ui ) {
          var Color_Hex = ColorFromValue(ui.value)

          $(event.target).find('.ui-slider-range').css('background-color', Color_Hex);

          HandleDisplay($(ui.handle), ui.value);
        },
        stop: function(event, ui){
          //console.log($('.slider-td'));
          ColorStates();
        }
      });

      HandleDisplay($(NewSlider).find('.ui-slider-handle'), EthnicityObj.Default);
      EthnicitySliders.append(NewSlider);
  });

  ColorStates();


});
